
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="test site">
      
      
        <meta name="author" content="Princess Rodriguez">
      
      
        <link rel="canonical" href="https://prodriguez19.github.io/MMG3320-5320/ch06/12_ClassExercise2_Align-Modify/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>12 ClassExercise2 Align Modify - MMG:3320 Advanced Bioinformatics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#class-exercise-3-modifying-the-hisat2-alignment-script-for-pe-samples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MMG:3320 Advanced Bioinformatics" class="md-header__button md-logo" aria-label="MMG:3320 Advanced Bioinformatics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MMG:3320 Advanced Bioinformatics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              12 ClassExercise2 Align Modify
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../slides/" class="md-tabs__link">
          
  
  Slides

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../pdf_materials/" class="md-tabs__link">
          
  
  Printouts

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ch01/" class="md-tabs__link">
          
  
  Lessons

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../assignments/week1_assignment/" class="md-tabs__link">
          
  
  Assignments

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MMG:3320 Advanced Bioinformatics" class="md-nav__button md-logo" aria-label="MMG:3320 Advanced Bioinformatics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MMG:3320 Advanced Bioinformatics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pdf_materials/MMG3320-Spring-2026-Syllabus.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syllabus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pdf_materials/MMG3320-Spring-2026-Schedule.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Schedule
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch01/gitbash-install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git Bash Install
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../FAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frequently Asked Questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch01/quick-start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Slides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Slides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../slides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Printouts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Printouts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pdf_materials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lessons
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Lessons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Week 1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Week 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch01/01_week1_mmg3320/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducing the Shell (L1)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch01/02_week1_mmg3320/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Navigating the Shell (L2)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Week 2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Week 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch02/03_week2_mmg3320/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wild Cards & Nano (L3)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Week 3
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Week 3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch03/04_week3_mmg3320/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Searching and Redirection (L4)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch03/05_week3_mmg3320/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Shell Scripting (L5)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Week 4
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Week 4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch04/06_week4_mmg3320/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loops (L6)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch04/07_week4_intro-to-RNAseq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RNA-Seq Overview (L7)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ch04/08_accessing_public_experimental_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing Public Data (L8)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Assignments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/week1_assignment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homework 1 (L1)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/week2_assignment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homework 2 (L3)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/week3_assignment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homework 3 (L5)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/week4_assignment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homework 4 (L5/L6)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/week5_assignment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homework 5 (L7/L8)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/assignment_schedule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assignment Schedule
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Final Project
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#class-exercise-3-modifying-the-hisat2-alignment-script-for-pe-samples" class="md-nav__link">
    <span class="md-ellipsis">
      Class Exercise 3: Modifying the HISAT2 alignment script for PE samples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class Exercise 3: Modifying the HISAT2 alignment script for PE samples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-loops" class="md-nav__link">
    <span class="md-ellipsis">
      For loops
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Instructions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>12 ClassExercise2 Align Modify</h1>

<div><h2 id="class-exercise-3-modifying-the-hisat2-alignment-script-for-pe-samples">Class Exercise 3: Modifying the HISAT2 alignment script for PE samples</h2>
<h3 id="overview">Overview</h3>
<p>Everyone will download at least six FASTQ files from the GEO repository for their final project. To ensure that the alignment and downstream processing steps are performed consistently for each sample, it is best to apply the same line of code to all samples simultaneously. To achieve this, we can use loops — a feature of programming languages that allows us to execute a series of commands on multiple files at once.</p>
<p>In addition to saving time, loops make your code more readable and concise. There are various types of loops, but we have focused on the for loop. At the end, you will be "creating" a script that could be used to align paired end samples using HISAT2. </p>
<p>The final outputs will be in a form of a BAM file. BAM is the binary version of a SAM (Sequence Alignment Map) file. A SAM file is a tab-delimited text file that contains information about each individual read and its alignment to the genome. However, SAM files are not a desirable output due to their large size. Therefore, we will immediately convert them to BAM files using SAMtools.</p>
<h3 id="for-loops">For loops</h3>
<p>For loops are constructed with 4 basic words: </p>
<table>
<thead>
<tr>
<th style="text-align: center;">Words</th>
<th style="text-align: left;">What it does</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">for</td>
<td style="text-align: left;">set the loop variable name</td>
</tr>
<tr>
<td style="text-align: center;">in</td>
<td style="text-align: left;">specify whatever it is we are looping over</td>
</tr>
<tr>
<td style="text-align: center;">do</td>
<td style="text-align: left;">specify what we want to do with each item</td>
</tr>
<tr>
<td style="text-align: center;">done</td>
<td style="text-align: left;">tell the computer we are done</td>
</tr>
</tbody>
</table>
<p>putting these together, for loop syntax is as follows: </p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span>VARIABLE<span class="w"> </span><span class="k">in</span><span class="w"> </span>file1<span class="w"> </span>file2<span class="w"> </span>file3
<span class="k">do</span>
<span class="w">  </span>command1<span class="w"> </span>on<span class="w"> </span><span class="nv">$VARIABLE</span>
<span class="w">  </span>command2<span class="w"> </span>
<span class="k">done</span>
</code></pre></div>
<p>A basic loop looks something like this when it’s written within a job script:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span>A<span class="w"> </span>B<span class="w"> </span>C
<span class="k">do</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$i</span>
<span class="k">done</span>
</code></pre></div>
<blockquote>
<p>The VARIABLE could be any letter or word that is meaningful, but is commonly represented by a single letter like "i" for ease. 
Often the <code>in</code> portion will be a directory instead of single files (A, B, C) - i.e. a directory that contains the FASTQ files you want to work with. </p>
</blockquote>
<h3 id="variables">Variables</h3>
<p>The variable portion of a for loop is the item that we are going to iterate over and will change with every “new” loop. <strong>The action is typically being performed on each individual file.</strong> In their simplest form variables can look like this:</p>
<div class="highlight"><pre><span></span><code><span class="nv">DIRECTORY</span><span class="o">=</span>PATH/TO/DIRECTORY

<span class="nv">DBDIR</span><span class="o">=</span>/users/p/d/pdrodrig/genome_index
</code></pre></div>
<blockquote>
<p>In the above example, this is showing a location to a specific directory </p>
</blockquote>
<p>As a reminder, if we want to make sure this assignment worked, use the <code>echo</code> command. This is a command that prints out whatever is provided to it, which can be really useful to test commands or report information back to yourself during a loop.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="nv">$DBDIR</span><span class="w"> </span>
</code></pre></div>
<h3 id="instructions">Instructions</h3>
<p>Let's start assembling our script. You will be copying and pasting the script in sections. </p>
<pre><code>+ The purpose of this exercise is the understand how the alignment script was composed. Therefore, take the time to read any of the descriptions provided.

+ Make a copy of the following folder located here:

```bash
/gpfs1/cl/mmg3320/course_materials/HISAT2-modify
```

+ You will see two FASTQ files inside called `JC1A_R1.fastq.gz` and  `JC1A_R2.fastq.gz`.

+ Open Jupyter Notebooks to "write" your alignment script using the step by step instructions below. Call the script `hisat2-modify-PE.sh`. Keep your terminal open as well.
</code></pre>
<ol>
<li>
<p>In lines 1-9, provide the job submission parameters. Copy-and-paste the following section: </p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --partition=general</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --ntasks=2</span>
<span class="c1">#SBATCH --mem=10G</span>
<span class="c1">#SBATCH --time=3:00:00</span>
<span class="c1">#SBATCH --job-name=align_CD8</span>
<span class="c1"># %x=job-name %j=jobid</span>
<span class="c1">#SBATCH --output=%x_%j.out</span>
</code></pre></div>
</li>
<li>
<p>In lines 11-16, copy-and-paste the next section. The importance of this section is that it will allow you to process all FASTQ files <em>while</em> maintaining the file name for each file output.  </p>
<div class="highlight"><pre><span></span><code><span class="c1"># Iterate through each fastq.gz file in the current directory</span>
<span class="k">for</span><span class="w"> </span>fastq_file<span class="w"> </span><span class="k">in</span><span class="w"> </span>*fastq.gz<span class="p">;</span><span class="w"> </span><span class="k">do</span>

<span class="w">    </span><span class="c1"># Extract sample name from the file name</span>
<span class="w">    </span><span class="nv">SAMPLE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="si">${</span><span class="nv">fastq_file</span><span class="si">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s2">"s/.fastq.gz//"</span><span class="k">)</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>.fastq.gz<span class="w"> </span>
</code></pre></div>
<p><strong>How does this maintain sample naming?</strong></p>
<ul>
<li>We define the variable <code>SAMPLE</code> as the sample name by using the <code>sed</code> command to remove <code>.fastq.gz</code> from each filename.<ul>
<li>This allows us to create a variable that effectively stores a list of all sample names.</li>
<li>For example, if the filename was <code>WT-REP1.fastq.gz</code>:<ul>
<li>The <code>sed</code> command removes <code>.fastq.gz</code>, leaving just <code>WT-REP1</code>.</li>
<li>When we <code>echo $SAMPLE</code>, it returns <code>WT-REP1</code> instead of the full filename.</li>
</ul>
</li>
</ul>
</li>
<li>Using <code>echo</code>, we can check that each sample name is correctly extracted.</li>
</ul>
</li>
<li>
<p>Next, copy-and-paste the following section into lines 18-21. Make sure to use the <code>tab</code> key to indent. </p>
<div class="highlight"><pre><span></span><code><span class="c1"># Set database directory, genome, and processor count</span>
<span class="nv">DBDIR</span><span class="o">=</span><span class="s2">"/gpfs1/cl/mmg3320/course_materials/genome_index/hisat2_index_mm10"</span>
<span class="nv">GENOME</span><span class="o">=</span><span class="s2">"GRCm39"</span>
<span class="nv">p</span><span class="o">=</span><span class="m">2</span>
</code></pre></div>
<p><strong>All of these are examples of variables. Each variable is assigned a specific value:</strong></p>
<ul>
<li><code>DBDIR</code> stores a file path to the genome index directory.</li>
<li><code>GENOME</code> stores a character string representing the genome version (GRCm39).</li>
<li><code>p</code> is set to a numeric value (2), which represents the number of processors to use.</li>
</ul>
<p><em>Variables help make the script more flexible and easier to modify by centralizing important parameters.</em></p>
</li>
<li>
<p>Next, copy-and-paste the following section into lines 23-26. The script will not run unless the required modules are loaded. </p>
<div class="highlight"><pre><span></span><code><span class="c1"># Load required modules</span>
module<span class="w"> </span>load<span class="w"> </span>gcc/13.3.0-xp3epyt
module<span class="w"> </span>load<span class="w"> </span>hisat2/2.2.1-x7h4grf
module<span class="w"> </span>load<span class="w"> </span>samtools/1.19.2-pfmpoam
</code></pre></div>
</li>
<li>
<p>Next, copy-and-paste the following section into lines 28-33. </p>
<div class="highlight"><pre><span></span><code><span class="c1"># Align reads to the reference genome</span>
hisat2<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="si">${</span><span class="nv">p</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-x<span class="w"> </span><span class="si">${</span><span class="nv">DBDIR</span><span class="si">}</span>/<span class="si">${</span><span class="nv">GENOME</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-U<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>.fastq.gz<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-S<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>.sam<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>.log
</code></pre></div>
</li>
<li>
<p>Move into your terminal tab. Do not close your script, we will return to it shortly. </p>
</li>
<li>
<p>Run the following command in your terminal. </p>
<div class="highlight"><pre><span></span><code>hisat2<span class="w"> </span>--help
</code></pre></div>
<ul>
<li>What does <code>-U</code> mean? </li>
<li>What does <code>-S</code> mean? </li>
<li>What does <code>-x</code> mean? </li>
</ul>
<p><em>Its really important that you take some time to understand what these parameters do!</em></p>
</li>
<li>
<p><strong>When you are ready, modify the script you copied-and-pasted to accommodate paired end reads</strong> </p>
<p>The paired-end files in this directory are: </p>
<div class="highlight"><pre><span></span><code>JC1A_R1.fastq.gz  JC1A_R2.fastq.gz
</code></pre></div>
<p><strong>Hints:</strong></p>
<ul>
<li>The loop should iterate only over <code>_1.fastq.gz</code> files to ensure proper pairing. If the script loops over all <code>*.fastq.gz</code> files, it will process both <code>_1.fastq.gz</code> and <code>_2.fastq.gz</code> files individually.</li>
<li>If the <code>SAMPLE</code> variable is set to <code>.fastq.gz</code> only, the samples will <strong>not</strong> distinguish between <code>_1.fastq.gz</code> and <code>_2.fastq.gz</code></li>
<li>Use <code>_1.fastq.gz</code> for forward reads and <code>_2.fastq.gz</code> for reverse reads.</li>
</ul>
</li>
<li>
<p>Copy-and paste the last section starting in line 36. When you are done, submit the script. </p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="c1"># Convert SAM to BAM</span>
<span class="w">    </span>samtools<span class="w"> </span>view<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>.sam<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>--threads<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-b<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-o<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>.bam

<span class="w">    </span><span class="c1"># Remove SAM file</span>
<span class="w">    </span>rm<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>.sam

<span class="w">    </span><span class="c1"># Generate alignment statistics</span>
<span class="w">    </span>samtools<span class="w"> </span>flagstat<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>.bam<span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>.txt

<span class="w">    </span><span class="c1"># Sort the BAM file by coordinates</span>
<span class="w">    </span>samtools<span class="w"> </span>sort<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>.bam<span class="w"> </span>-o<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>_sorted.bam

<span class="w">    </span><span class="c1"># Index the sorted BAM file</span>
<span class="w">    </span>samtools<span class="w"> </span>index<span class="w"> </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span>_sorted.bam

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"Sample </span><span class="si">${</span><span class="nv">SAMPLE</span><span class="si">}</span><span class="s2"> processing complete."</span>
<span class="k">done</span>
</code></pre></div>
<p>The final files output should include the following: </p>
<div class="highlight"><pre><span></span><code>align_CD8_60836.out<span class="w">  </span>JC1A.log<span class="w">          </span>JC1A_R2.fastq.gz<span class="w">  </span>JC1A_sorted.bam.bai<span class="w">  </span>
JC1A.bam<span class="w">             </span>JC1A_R1.fastq.gz<span class="w">  </span>JC1A_sorted.bam<span class="w">   </span>JC1A.txt
</code></pre></div>
<p><strong>We will review these outputs during next class.</strong> </p>
</li>
</ol></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.annotate", "content.code.select", "navigation.tabs", "navigation.top"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>